<!DOCTYPE html><html lang="fr"><head><meta charset="UTF-8"><link rel="preconnect" href="https://fonts.googleapis.com"><link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800;900&display=swap" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
<title>MPG — Cumul de points</title><style>
:root{--blue:#4054CC;--green:#45C945;--grad:linear-gradient(135deg,#4054CC 0%,#45C945 100%);
  --bg:#F4F6F8;--surface:#FFFFFF;--border:#D8DAE8;--text:#1A1F2E;--muted:#959DAF;
  --gold:#F5A623;--silver:#8A9BAD;--bronze:#C8845A;--red:#C0303A;}
*{box-sizing:border-box;margin:0;padding:0;}
body{background:var(--bg);color:var(--text);font-family:'Nunito','Avenir',sans-serif;}
html,body{height:100%;overflow:hidden;}
body{display:flex;flex-direction:column;}
.topbar{background:var(--surface);border-bottom:3px solid transparent;
  border-image:linear-gradient(to right,var(--blue),var(--green)) 1;
  padding:10px 20px;display:flex;align-items:center;gap:12px;flex-shrink:0;
  box-shadow:0 2px 8px rgba(0,0,0,.05);}
.title-wrap{display:flex;align-items:baseline;gap:8px;}
.topbar h1{font-size:.92rem;font-weight:900;color:var(--text);}
.topbar .sub{font-size:.7rem;color:var(--muted);}
.controls{display:flex;align-items:center;gap:10px;margin-left:auto;}
.btn{padding:6px 18px;border:none;border-radius:20px;cursor:pointer;font-size:.78rem;
  font-weight:800;font-family:'Nunito',sans-serif;transition:opacity .15s;}
.btn:hover{opacity:.85;}
.btn-play{background:var(--grad);color:#fff;}
.btn-reset{background:var(--bg);color:var(--muted);border:1px solid var(--border);}
.speed-wrap{display:flex;align-items:center;gap:6px;font-size:.72rem;color:var(--muted);}
input[type=range]{width:80px;accent-color:var(--blue);cursor:pointer;}
.progress{font-size:.72rem;color:var(--muted);font-weight:700;min-width:64px;text-align:right;}
.chart-wrap{flex:1;min-height:0;padding:12px 16px 6px;}
.chart-card{background:var(--surface);border:1px solid var(--border);border-radius:14px;
  box-shadow:0 2px 12px rgba(0,0,0,.05);height:100%;padding:6px;}
canvas{width:100%!important;height:100%!important;}
.legend{display:flex;flex-wrap:wrap;gap:6px;padding:6px 16px 12px;flex-shrink:0;}
.leg{display:flex;align-items:center;gap:5px;cursor:pointer;font-size:.72rem;font-weight:700;
  padding:4px 10px;border-radius:20px;background:var(--surface);border:1.5px solid var(--border);
  color:var(--text);transition:opacity .2s,border-color .2s;}
.leg:hover{border-color:var(--blue);}
.leg.hidden{opacity:.3;}
.leg-dot{width:8px;height:8px;border-radius:50%;flex-shrink:0;}
</style></head><body>
<div class="topbar">
  <a href="index.html" style="font-size:12px;font-weight:700;color:#4054CC;text-decoration:none;white-space:nowrap;padding:4px 10px;border-radius:12px;background:#EEF1FF;border:1px solid #C5CBF5;flex-shrink:0;">← Accueil</a>
  <div class="title-wrap">
    <h1>Cumul de points</h1><span class="sub">18 saisons hors COVID · Raph 1er avec 398 pts, seulement 89 pts séparent le 1er du 8e</span>
  </div>
  <div class="controls">
    <button class="btn btn-play" id="btnPlay">▶ Play</button>
    <button class="btn btn-reset" id="btnReset">↺</button>
    <div class="speed-wrap"><span>Vitesse</span>
      <input type="range" id="speed" min="1" max="10" value="5"></div>
    <span class="progress" id="progress">—</span>
  </div>
</div>
<div class="chart-wrap"><div class="chart-card"><canvas id="chart"></canvas></div></div>
<div class="legend" id="legend"></div>
<script>
const RAW={"labels": ["S1.J1", "S1.J2", "S1.J3", "S1.J4", "S1.J5", "S1.J6", "S1.J7", "S1.J8", "S1.J9", "S1.J10", "S1.J11", "S1.J12", "S1.J13", "S1.J14", "S2.J1", "S2.J2", "S2.J3", "S2.J4", "S2.J5", "S2.J6", "S2.J7", "S2.J8", "S2.J9", "S2.J10", "S2.J11", "S2.J12", "S2.J13", "S2.J14", "S3.J1", "S3.J2", "S3.J3", "S3.J4", "S3.J5", "S3.J6", "S3.J7", "S3.J8", "S3.J9", "S3.J10", "S3.J11", "S3.J12", "S3.J13", "S3.J14", "S4.J1", "S4.J2", "S4.J3", "S4.J4", "S4.J5", "S4.J6", "S4.J7", "S4.J8", "S4.J9", "S4.J10", "S4.J11", "S4.J12", "S4.J13", "S4.J14", "S5.J1", "S5.J2", "S5.J3", "S5.J4", "S5.J5", "S5.J6", "S5.J7", "S5.J8", "S5.J9", "S5.J10", "S5.J11", "S5.J12", "S5.J13", "S5.J14", "S6.J1", "S6.J2", "S6.J3", "S6.J4", "S6.J5", "S6.J6", "S6.J7", "S6.J8", "S6.J9", "S6.J10", "S6.J11", "S6.J12", "S6.J13", "S6.J14", "S7.J1", "S7.J2", "S7.J3", "S7.J4", "S7.J5", "S7.J6", "S7.J7", "S7.J8", "S7.J9", "S7.J10", "S7.J11", "S7.J12", "S7.J13", "S7.J14", "S8.J1", "S8.J2", "S8.J3", "S8.J4", "S8.J5", "S8.J6", "S8.J7", "S8.J8", "S8.J9", "S8.J10", "S8.J11", "S8.J12", "S8.J13", "S8.J14", "S9.J1", "S9.J2", "S9.J3", "S9.J4", "S9.J5", "S9.J6", "S9.J7", "S9.J8", "S9.J9", "S9.J10", "S9.J11", "S9.J12", "S9.J13", "S9.J14", "S10.J1", "S10.J2", "S10.J3", "S10.J4", "S10.J5", "S10.J6", "S10.J7", "S10.J8", "S10.J9", "S10.J10", "S10.J11", "S10.J12", "S10.J13", "S10.J14", "S11.J1", "S11.J2", "S11.J3", "S11.J4", "S11.J5", "S11.J6", "S11.J7", "S11.J8", "S11.J9", "S11.J10", "S11.J11", "S11.J12", "S11.J13", "S11.J14", "S12.J1", "S12.J2", "S12.J3", "S12.J4", "S12.J5", "S12.J6", "S12.J7", "S12.J8", "S12.J9", "S12.J10", "S12.J11", "S12.J12", "S12.J13", "S12.J14", "S13.J1", "S13.J2", "S13.J3", "S13.J4", "S13.J5", "S13.J6", "S13.J7", "S13.J8", "S13.J9", "S13.J10", "S13.J11", "S13.J12", "S13.J13", "S13.J14", "S14.J1", "S14.J2", "S14.J3", "S14.J4", "S14.J5", "S14.J6", "S14.J7", "S14.J8", "S14.J9", "S14.J10", "S14.J11", "S14.J12", "S14.J13", "S14.J14", "S15.J1", "S15.J2", "S15.J3", "S15.J4", "S15.J5", "S15.J6", "S15.J7", "S15.J8", "S15.J9", "S15.J10", "S15.J11", "S15.J12", "S15.J13", "S15.J14", "S16.J1", "S16.J2", "S16.J3", "S16.J4", "S16.J5", "S16.J6", "S16.J7", "S16.J8", "S16.J9", "S16.J10", "S16.J11", "S16.J12", "S16.J13", "S16.J14", "S17.J1", "S17.J2", "S17.J3", "S17.J4", "S17.J5", "S17.J6", "S17.J7", "S17.J8", "S17.J9", "S17.J10", "S17.J11", "S17.J12", "S17.J13", "S17.J14", "S18.J1", "S18.J2", "S18.J3", "S18.J4", "S18.J5", "S18.J6", "S18.J7", "S18.J8", "S18.J9", "S18.J10", "S18.J11", "S18.J12", "S18.J13", "S18.J14", "S19.J1", "S19.J2", "S19.J3", "S19.J4", "S19.J5", "S19.J6", "S19.J7", "S19.J8", "S19.J9", "S19.J10", "S19.J11", "S19.J12", "S19.J13", "S19.J14"], "players": [{"id": "raph", "name": "Raph", "color": "#C0303A", "data": [0, 0, 3, 3, 4, 4, 4, 5, 5, 5, 8, 8, 11, 11, 14, 14, 17, 18, 21, 24, 27, 27, 30, 30, 30, 30, 33, 36, 39, 40, 41, 41, 42, 43, 43, 43, 46, 49, 49, 50, 50, 50, 51, 54, 57, 58, 61, 64, 64, 67, 70, 73, 74, 77, 80, 81, 84, 87, 90, 90, 90, 93, 93, 93, 96, 97, 100, 100, 100, 103, 106, 109, 112, 112, 112, 115, 118, 118, 118, 121, 121, 122, 123, 124, 127, 130, 130, 133, 134, 137, 140, 141, 144, 145, 146, 146, 149, 152, 155, 155, 155, 156, 159, 160, 161, 162, 162, 162, 165, 168, 168, 168, 168, 168, 168, 171, 174, 177, 180, 183, 184, 185, 185, 186, 186, 186, 186, 189, 189, 190, 193, 193, 194, 195, 198, 201, 201, 201, 204, 207, 207, 210, 213, 214, 217, 218, 221, 221, 224, 227, 230, 233, 233, 234, 237, 240, 243, 246, 249, 252, 252, 252, 255, 256, 259, 260, 263, 264, 265, 268, 268, 268, 268, 268, 271, 271, 271, 274, 275, 278, 281, 284, 284, 287, 288, 291, 294, 297, 300, 303, 306, 309, 310, 310, 310, 313, 314, 317, 317, 317, 318, 318, 321, 324, 324, 325, 328, 331, 334, 335, 335, 335, 335, 335, 338, 341, 344, 345, 345, 346, 349, 349, 349, 349, 349, 352, 355, 355, 356, 356, 359, 362, 365, 365, 368, 371, 374, 374, 377, 380, 380, 380, 380, 383, 386, 386, 389, 389, 392, 395, 395, 398, 401, 401, 401, 401, 401, 401, 401, 401, 401, 401, 401, 401, 401, 401]}, {"id": "nico", "name": "Nico", "color": "#2E6A99", "data": [0, 0, 3, 6, 6, 9, 12, 15, 18, 18, 18, 21, 21, 24, 27, 30, 33, 36, 36, 39, 39, 40, 41, 41, 41, 44, 45, 45, 48, 48, 48, 51, 51, 52, 55, 58, 61, 64, 67, 70, 71, 72, 75, 76, 76, 79, 79, 82, 85, 88, 91, 91, 94, 97, 97, 100, 100, 101, 102, 105, 108, 111, 114, 117, 117, 120, 120, 121, 122, 122, 122, 122, 122, 125, 125, 128, 131, 131, 134, 137, 138, 141, 144, 145, 148, 148, 148, 148, 151, 154, 154, 157, 157, 160, 163, 164, 165, 168, 171, 171, 171, 172, 172, 175, 178, 181, 181, 181, 181, 184, 185, 186, 187, 190, 190, 193, 194, 194, 197, 197, 198, 201, 202, 202, 202, 202, 205, 208, 211, 211, 214, 214, 217, 218, 219, 219, 219, 219, 222, 223, 226, 227, 227, 230, 233, 236, 236, 236, 239, 239, 240, 241, 242, 243, 246, 246, 246, 246, 246, 249, 250, 253, 254, 254, 254, 255, 256, 257, 258, 258, 258, 259, 262, 262, 263, 266, 266, 269, 269, 269, 272, 272, 275, 275, 278, 278, 279, 282, 285, 288, 288, 288, 291, 294, 297, 297, 300, 300, 300, 301, 301, 304, 304, 305, 308, 311, 314, 317, 317, 318, 321, 324, 327, 330, 330, 333, 336, 337, 340, 341, 341, 344, 347, 348, 351, 351, 351, 352, 352, 352, 352, 355, 355, 358, 358, 361, 361, 364, 364, 364, 364, 367, 370, 373, 376, 379, 382, 385, 385, 385, 388, 388, 388, 389, 389, 389, 389, 389, 389, 389, 389, 389, 389, 389, 389, 389]}, {"id": "francois", "name": "Fran\u00e7ois", "color": "#1E5C3A", "data": [3, 6, 6, 6, 9, 9, 12, 15, 18, 18, 21, 21, 24, 27, 28, 31, 31, 34, 37, 37, 40, 43, 44, 47, 50, 53, 54, 57, 57, 58, 58, 58, 61, 62, 65, 68, 69, 70, 70, 73, 74, 75, 75, 75, 75, 75, 76, 79, 82, 82, 83, 86, 86, 89, 89, 90, 90, 93, 93, 94, 97, 97, 97, 97, 100, 101, 101, 104, 105, 108, 109, 110, 113, 116, 119, 122, 125, 128, 129, 129, 132, 132, 135, 138, 138, 139, 142, 142, 145, 145, 148, 151, 154, 155, 156, 156, 159, 159, 159, 160, 161, 162, 165, 168, 168, 169, 170, 173, 176, 176, 176, 176, 176, 176, 179, 179, 180, 181, 184, 185, 185, 186, 187, 187, 187, 187, 187, 190, 190, 193, 193, 193, 196, 199, 199, 202, 202, 205, 208, 211, 214, 217, 220, 223, 223, 224, 224, 227, 228, 231, 234, 235, 238, 241, 241, 244, 244, 247, 250, 250, 253, 253, 254, 254, 257, 260, 260, 261, 264, 267, 267, 270, 273, 274, 277, 278, 281, 281, 282, 283, 286, 289, 292, 292, 293, 296, 297, 300, 303, 306, 306, 306, 306, 306, 309, 309, 309, 312, 315, 316, 317, 317, 320, 321, 324, 325, 325, 325, 328, 328, 329, 332, 333, 333, 333, 333, 333, 336, 339, 342, 343, 343, 343, 346, 346, 346, 346, 349, 352, 353, 353, 356, 359, 362, 363, 363, 363, 366, 366, 369, 370, 373, 373, 376, 376, 377, 377, 380, 380, 380, 380, 380, 380, 383, 383, 383, 383, 383, 383, 383, 383, 383, 383, 383, 383, 383]}, {"id": "damien", "name": "Damien", "color": "#C08A00", "data": [3, 6, 9, 12, 15, 18, 21, 24, 24, 27, 27, 27, 27, 30, 31, 34, 34, 37, 37, 38, 41, 41, 42, 45, 48, 51, 54, 57, 58, 61, 64, 67, 67, 68, 68, 71, 71, 72, 72, 75, 78, 78, 78, 81, 81, 82, 85, 88, 88, 89, 90, 93, 94, 94, 97, 97, 98, 98, 101, 104, 107, 110, 110, 111, 111, 111, 111, 112, 115, 118, 121, 122, 125, 128, 128, 129, 129, 132, 133, 134, 137, 140, 141, 142, 142, 142, 143, 146, 146, 149, 149, 152, 152, 155, 155, 158, 161, 161, 161, 164, 165, 165, 166, 166, 166, 167, 170, 170, 170, 173, 176, 177, 180, 181, 184, 187, 188, 189, 189, 190, 190, 193, 193, 196, 197, 200, 203, 203, 206, 206, 209, 209, 210, 213, 214, 214, 217, 217, 217, 218, 218, 218, 221, 224, 224, 224, 227, 228, 228, 228, 231, 231, 232, 232, 232, 235, 238, 238, 239, 242, 245, 248, 249, 252, 252, 252, 252, 253, 256, 256, 259, 262, 262, 265, 268, 269, 270, 270, 273, 274, 274, 277, 277, 280, 280, 280, 280, 280, 280, 281, 284, 287, 290, 293, 293, 296, 299, 299, 299, 299, 302, 302, 303, 304, 307, 310, 310, 310, 313, 313, 313, 316, 317, 317, 317, 318, 321, 322, 325, 325, 326, 329, 329, 332, 335, 338, 341, 341, 341, 344, 344, 344, 347, 350, 351, 352, 355, 358, 361, 361, 364, 364, 364, 367, 370, 371, 371, 371, 371, 371, 371, 374, 377, 380, 380, 380, 380, 380, 380, 380, 380, 380, 380, 380, 380, 380]}, {"id": "greg", "name": "Greg", "color": "#D4643A", "data": [3, 4, 7, 7, 10, 13, 13, 14, 17, 20, 23, 26, 26, 26, 26, 26, 29, 29, 32, 33, 36, 39, 40, 43, 43, 46, 46, 49, 50, 51, 51, 54, 57, 60, 63, 63, 64, 64, 65, 65, 68, 71, 74, 77, 80, 80, 80, 80, 83, 83, 83, 83, 86, 86, 89, 92, 93, 94, 95, 96, 96, 96, 96, 99, 102, 105, 108, 109, 112, 115, 116, 119, 119, 120, 123, 123, 123, 124, 124, 124, 124, 124, 124, 124, 127, 130, 133, 133, 134, 134, 137, 137, 140, 143, 143, 146, 147, 147, 150, 153, 156, 156, 159, 162, 165, 166, 169, 172, 173, 173, 176, 179, 180, 183, 183, 186, 186, 187, 188, 191, 194, 194, 197, 198, 201, 201, 201, 201, 202, 202, 205, 208, 208, 208, 211, 214, 217, 217, 217, 218, 218, 219, 219, 219, 219, 219, 222, 222, 222, 222, 222, 222, 225, 225, 228, 228, 228, 228, 231, 231, 232, 232, 233, 233, 234, 234, 234, 235, 238, 241, 241, 242, 242, 245, 245, 245, 246, 249, 252, 255, 255, 255, 258, 258, 258, 258, 259, 259, 259, 259, 259, 262, 265, 268, 271, 271, 271, 274, 277, 280, 281, 284, 284, 285, 285, 288, 291, 291, 294, 297, 300, 300, 303, 306, 309, 309, 309, 310, 310, 310, 311, 314, 314, 315, 318, 319, 319, 320, 321, 322, 325, 325, 325, 325, 328, 328, 331, 334, 334, 334, 335, 338, 338, 338, 339, 340, 343, 343, 346, 349, 352, 355, 358, 358, 358, 358, 358, 358, 358, 358, 358, 358, 358, 358, 358, 358]}, {"id": "marc", "name": "Marc", "color": "#1A3D50", "data": [0, 1, 1, 4, 5, 8, 8, 8, 8, 11, 11, 14, 14, 14, 17, 17, 17, 17, 20, 20, 20, 20, 21, 22, 22, 22, 22, 22, 25, 26, 29, 32, 35, 38, 38, 41, 41, 44, 47, 47, 47, 48, 51, 51, 51, 54, 54, 54, 54, 55, 58, 58, 61, 62, 62, 62, 63, 63, 64, 65, 65, 68, 71, 72, 72, 72, 72, 73, 74, 74, 75, 78, 78, 78, 78, 78, 78, 79, 80, 81, 82, 85, 86, 86, 89, 92, 95, 98, 99, 99, 99, 99, 102, 102, 103, 106, 106, 109, 109, 112, 113, 116, 116, 117, 120, 120, 123, 123, 126, 129, 132, 132, 132, 132, 135, 135, 138, 138, 138, 138, 138, 138, 141, 144, 147, 150, 150, 150, 151, 154, 154, 157, 158, 161, 161, 161, 164, 167, 167, 167, 170, 171, 171, 171, 174, 175, 175, 176, 179, 179, 180, 180, 180, 183, 186, 186, 186, 189, 189, 192, 192, 195, 198, 199, 202, 205, 208, 209, 209, 212, 215, 215, 215, 218, 218, 219, 222, 222, 222, 225, 228, 228, 228, 231, 232, 235, 236, 239, 239, 239, 242, 242, 242, 242, 242, 242, 243, 243, 243, 246, 249, 252, 253, 253, 253, 253, 253, 253, 253, 256, 257, 258, 258, 258, 261, 261, 262, 262, 262, 265, 268, 268, 271, 274, 277, 277, 277, 277, 280, 283, 283, 283, 283, 286, 286, 287, 290, 290, 293, 296, 299, 299, 302, 302, 302, 303, 306, 309, 309, 312, 315, 318, 319, 322, 322, 322, 322, 322, 322, 322, 322, 322, 322, 322, 322, 322]}, {"id": "pierre", "name": "Pierre", "color": "#2A8FA0", "data": [3, 3, 3, 3, 3, 3, 6, 6, 6, 9, 9, 9, 12, 15, 15, 18, 18, 18, 18, 18, 18, 21, 21, 21, 24, 24, 27, 27, 27, 30, 33, 33, 34, 34, 34, 34, 34, 34, 37, 38, 38, 39, 39, 39, 42, 42, 43, 43, 43, 46, 46, 49, 49, 49, 49, 49, 50, 51, 52, 53, 53, 53, 56, 56, 59, 59, 62, 62, 62, 62, 62, 62, 65, 65, 68, 68, 71, 74, 77, 77, 77, 77, 77, 80, 80, 80, 81, 84, 84, 87, 87, 88, 88, 88, 91, 92, 92, 95, 95, 95, 98, 99, 100, 100, 101, 104, 104, 107, 107, 107, 107, 110, 113, 114, 117, 117, 118, 121, 122, 125, 128, 128, 131, 134, 137, 140, 143, 146, 149, 150, 150, 153, 154, 154, 157, 157, 160, 163, 163, 164, 167, 168, 171, 171, 174, 175, 175, 178, 178, 181, 181, 184, 187, 188, 188, 191, 194, 194, 195, 195, 198, 201, 201, 204, 204, 207, 208, 211, 211, 211, 214, 217, 220, 220, 221, 222, 225, 228, 228, 228, 228, 231, 231, 231, 234, 237, 238, 238, 238, 238, 241, 241, 241, 244, 247, 250, 253, 253, 256, 256, 256, 259, 262, 263, 263, 263, 266, 269, 269, 272, 272, 273, 273, 276, 279, 282, 282, 282, 285, 286, 286, 289, 292, 292, 292, 295, 298, 301, 302, 302, 305, 308, 308, 308, 308, 308, 308, 308, 308, 308, 308, 308, 311, 311, 312, 315, 315, 315, 318, 321, 321, 321, 321, 321, 321, 321, 321, 321, 321, 321, 321, 321, 321, 321, 321, 321]}, {"id": "manu", "name": "Manu", "color": "#7A1A1E", "data": [0, 3, 3, 6, 6, 6, 6, 6, 9, 9, 12, 15, 18, 18, 18, 18, 21, 22, 22, 25, 25, 26, 27, 28, 31, 31, 31, 31, 31, 31, 32, 32, 32, 32, 35, 35, 38, 38, 39, 39, 42, 45, 46, 47, 50, 53, 56, 56, 59, 59, 59, 59, 59, 60, 63, 66, 69, 70, 70, 70, 73, 73, 76, 79, 79, 82, 85, 88, 89, 89, 90, 90, 90, 91, 94, 95, 95, 95, 96, 99, 102, 103, 104, 105, 105, 106, 106, 106, 107, 107, 110, 110, 110, 110, 111, 111, 111, 111, 114, 115, 116, 119, 119, 119, 119, 119, 120, 123, 124, 124, 125, 128, 131, 134, 134, 134, 134, 135, 135, 135, 138, 141, 141, 141, 142, 145, 148, 148, 148, 151, 151, 154, 154, 154, 154, 157, 157, 160, 163, 163, 163, 163, 163, 164, 164, 167, 170, 173, 174, 177, 177, 180, 180, 181, 181, 181, 184, 187, 187, 187, 187, 187, 187, 190, 191, 191, 194, 194, 194, 194, 197, 197, 200, 201, 201, 204, 204, 204, 207, 207, 207, 207, 210, 213, 214, 214, 215, 215, 218, 219, 219, 222, 223, 223, 223, 226, 226, 229, 232, 235, 236, 236, 236, 237, 240, 240, 240, 243, 243, 243, 246, 246, 249, 252, 252, 253, 254, 257, 257, 258, 259, 259, 262, 262, 262, 263, 266, 269, 270, 273, 276, 276, 279, 279, 282, 285, 285, 285, 288, 291, 294, 297, 300, 300, 300, 300, 300, 303, 306, 306, 309, 309, 310, 311, 311, 311, 311, 311, 311, 311, 311, 311, 311, 311, 311, 311]}], "seasons": [{"snum": 1, "year": 2016, "start": 0, "end": 13}, {"snum": 2, "year": 2016, "start": 14, "end": 27}, {"snum": 3, "year": 2017, "start": 28, "end": 41}, {"snum": 4, "year": 2017, "start": 42, "end": 55}, {"snum": 5, "year": 2018, "start": 56, "end": 69}, {"snum": 6, "year": 2018, "start": 70, "end": 83}, {"snum": 7, "year": 2019, "start": 84, "end": 97}, {"snum": 8, "year": 2020, "start": 98, "end": 111}, {"snum": 9, "year": 2020, "start": 112, "end": 125}, {"snum": 10, "year": 2021, "start": 126, "end": 139}, {"snum": 11, "year": 2021, "start": 140, "end": 153}, {"snum": 12, "year": 2022, "start": 154, "end": 167}, {"snum": 13, "year": 2022, "start": 168, "end": 181}, {"snum": 14, "year": 2023, "start": 182, "end": 195}, {"snum": 15, "year": 2023, "start": 196, "end": 209}, {"snum": 16, "year": 2024, "start": 210, "end": 223}, {"snum": 17, "year": 2024, "start": 224, "end": 237}, {"snum": 18, "year": 2025, "start": 238, "end": 251}, {"snum": 19, "year": 2025, "start": 252, "end": 265}]};
const N=RAW.labels.length,DATA_WIN=5*14,EMPTY_WIN=2*14;
let frame=0,timer=null,hidden={},winStart=0;
const datasets=RAW.players.map(p=>({label:p.name,data:[],borderColor:p.color,
  backgroundColor:p.color+'18',borderWidth:2.5,pointRadius:0,tension:0.35,fill:false,spanGaps:false}));
const seasonAxis={id:'seasonAxis',afterDraw(ch){
  const {ctx,chartArea:ca,scales:sc}=ch;
  if(!sc.x||!ch.data.labels.length)return;
  const lbls=ch.data.labels,dLen=Math.min(DATA_WIN,lbls.length);
  if(lbls.length>dLen){
    const x0=sc.x.getPixelForValue(dLen-1)+(sc.x.getPixelForValue(dLen)-sc.x.getPixelForValue(dLen-1))/2;
    ctx.save();ctx.fillStyle='rgba(64,84,204,.04)';
    ctx.fillRect(x0,ca.top,ca.right-x0,ca.bottom-ca.top);
    ctx.setLineDash([4,4]);ctx.strokeStyle='#C8CEEE';ctx.lineWidth=1;
    ctx.beginPath();ctx.moveTo(x0,ca.top);ctx.lineTo(x0,ca.bottom);ctx.stroke();ctx.restore();
  }
  const BAR=38,bTop=ca.bottom+4;
  const vis=[];
  RAW.seasons.forEach(s=>{
    const ls=s.start-winStart,le=s.end-winStart;
    if(le<0||ls>=lbls.length)return;
    vis.push({...s,ls:Math.max(0,ls),le:Math.min(lbls.length-1,le)});
  });
  ctx.save();ctx.beginPath();ctx.rect(ca.left,bTop,ca.right-ca.left,BAR);ctx.clip();
  vis.forEach((s,i)=>{
    const xL=sc.x.getPixelForValue(s.ls);
    const xR=sc.x.getPixelForValue(s.le)+(s.le<lbls.length-1?(sc.x.getPixelForValue(s.le+1)-sc.x.getPixelForValue(s.le))/2:0);
    const w=xR-xL,cx=xL+w/2,isEmpty=s.ls>=dLen;
    ctx.fillStyle=s.snum%2===0?'rgba(64,84,204,.04)':'rgba(0,0,0,0)';
    ctx.fillRect(xL,bTop,w,BAR);
    ctx.strokeStyle='#D8DAE8';ctx.lineWidth=1;ctx.setLineDash([]);
    ctx.beginPath();ctx.moveTo(xL,bTop);ctx.lineTo(xL,bTop+BAR);ctx.stroke();
    if(w>18){
      ctx.fillStyle=isEmpty?'#C8CEE8':'#4054CC';
      ctx.font='bold 11px Nunito,sans-serif';
      ctx.textAlign='center';ctx.textBaseline='middle';
      ctx.fillText('S'+s.snum,cx,bTop+12);
    }
    const pv=i>0?vis[i-1].year:null;
    if(w>28&&(s.year!==pv||i===0)){
      ctx.fillStyle=isEmpty?'#C8CEE8':'#959DAF';
      ctx.font='10px Nunito,sans-serif';
      ctx.fillText(s.year,cx,bTop+27);
    }
  });
  ctx.setLineDash([]);ctx.strokeStyle='#D8DAE8';ctx.lineWidth=1;
  ctx.beginPath();ctx.moveTo(ca.left,bTop);ctx.lineTo(ca.right,bTop);ctx.stroke();
  ctx.restore();
}};
const refLine={id:'refLine',afterDraw(ch){
  const {ctx,chartArea:ca,scales:sc}=ch;if(!sc.y)return;
  const y=sc.y.getPixelForValue(1.5);
  ctx.save();ctx.setLineDash([5,4]);ctx.strokeStyle='#C8CEE8';ctx.lineWidth=1.5;
  ctx.beginPath();ctx.moveTo(ca.left,y);ctx.lineTo(ca.right,y);ctx.stroke();ctx.restore();
}};
const chart=new Chart(document.getElementById('chart'),{
  type:'line',data:{labels:[],datasets},plugins:[seasonAxis,refLine],
  options:{responsive:true,maintainAspectRatio:false,animation:false,
    layout:{padding:{bottom:48}},
    plugins:{legend:{display:false},
      tooltip:{mode:'index',intersect:false,
        backgroundColor:'#fff',borderColor:'#D8DAE8',borderWidth:1,
        titleColor:'#959DAF',bodyColor:'#1A1F2E',
        bodyFont:{family:'Nunito'},titleFont:{family:'Nunito',weight:'bold'},
        filter:i=>i.parsed.y!==null,
        callbacks:{
          title:items=>chart.data.labels[items[0].dataIndex]??'',
          label:c=>c.parsed.y==null?null:` ${c.dataset.label}: ${c.parsed.y.toFixed(3)}`,
        }
      }
    },
    scales:{
      x:{ticks:{display:false},grid:{display:false},border:{display:false}},
      y:{min:0,max:100,
        ticks:{color:'#959DAF',font:{family:'Nunito',size:11}},
        grid:{color:'#EEF0F8'},border:{dash:[4,4]},
        title:{display:true,text:'pts cumulés',color:'#959DAF',font:{family:'Nunito',size:11}},
      }
    }
  }
});
document.getElementById('legend').innerHTML=RAW.players.map((p,i)=>
  `<div class="leg" data-i="${i}"><div class="leg-dot" style="background:${p.color}"></div>${p.name}</div>`
).join('');
document.querySelectorAll('.leg').forEach(el=>{
  el.addEventListener('click',()=>{
    const i=+el.dataset.i;hidden[i]=!hidden[i];
    chart.data.datasets[i].hidden=hidden[i];
    el.classList.toggle('hidden',hidden[i]);chart.update('none');
  });
});
function yRange(s,e){
  let mn=Infinity,mx=-Infinity;
  for(let i=s;i<e;i++)RAW.players.forEach((p,pi)=>{
    if(hidden[pi])return;const v=p.data[i];
    if(v!=null){mn=Math.min(mn,v);mx=Math.max(mx,v);}
  });
  if(!isFinite(mn))return[0,100];
  const pad=Math.max((mx-mn)*.18,.05);
  return[Math.max(0,Math.floor((mn-pad)*20)/20),Math.min(9999,Math.ceil((mx+pad)*20)/20)];
}
function delay(){return Math.round(800/parseInt(document.getElementById('speed').value));}
function step(){
  if(frame>=N){stop();return;}
  const ds=Math.max(0,frame-DATA_WIN+1),de=frame+1,ee=Math.min(N,frame+EMPTY_WIN+1);
  winStart=ds;chart.data.labels=RAW.labels.slice(ds,ee);
  const dLen=de-ds;
  RAW.players.forEach((p,i)=>{
    chart.data.datasets[i].data=[...p.data.slice(ds,de),...Array(chart.data.labels.length-dLen).fill(null)];
  });
  const[mn,mx]=yRange(ds,de);
  chart.options.scales.y.min=mn;chart.options.scales.y.max=mx;
  chart.update('none');
  document.getElementById('progress').textContent=RAW.labels[frame];
  frame++;timer=setTimeout(step,delay());
}
function stop(){clearTimeout(timer);timer=null;
  document.getElementById('btnPlay').textContent=frame>=N?'✓ Fin':'▶ Play';}
document.getElementById('btnPlay').addEventListener('click',()=>{
  if(timer){stop();return;}if(frame>=N)return;
  document.getElementById('btnPlay').textContent='⏸ Pause';step();
});
document.getElementById('btnReset').addEventListener('click',()=>{
  stop();frame=0;winStart=0;chart.data.labels=[];
  chart.data.datasets.forEach(d=>d.data=[]);
  chart.options.scales.y.min=0;chart.options.scales.y.max=100;
  chart.update('none');document.getElementById('progress').textContent='—';
  document.getElementById('btnPlay').textContent='▶ Play';
});
</script>
</body></html>